On db2
COPY (select to_char("DATE-OBS", 'YYYYMMDDHH24MISS')"DATE", "DATE-OBS", "TELESCOP", "INSTRUME", "WAVELNTH", "CAMERA", "BUNIT", "ORIGIN", "CONTENT", "QUALITY", "QUALLEV1", "BLD_VERS", "HCAMID", "SOURCE", "TOTVALS", "DATAVALS", "MISSVALS", "SATVALS", "DATAMIN2", "DATAMAX2", "DATAMED2", "DATAMEA2", "DATARMS2", "DATASKE2", "DATAKUR2", "DATAMIN", "DATAMAX", "DATAMEDN", "DATAMEAN", "DATARMS", "DATASKEW", "DATAKURT", "CTYPE1", "CTYPE2", "CRPIX1", "CRPIX2", "CRVAL1", "CRVAL2", "CDELT1", "CDELT2", "CUNIT1", "CUNIT2", "CROTA2", "CRDER1", "CRDER2", "CSYSER1", "CSYSER2", "WCSNAME", "DSUN_OBS", "DSUN_REF", "RSUN_REF", "CRLN_OBS", "CRLT_OBS", "CAR_ROT", "OBS_VR", "OBS_VW", "OBS_VN", "RSUN_OBS", "T_OBS", "T_REC", "CADENCE", "DATASIGN", "HFLID", "HCFTID", "QLOOK", "CAL_FSN", "LUTQUERY", "TSEL", "TFRONT", "TINTNUM", "SINTNUM", "DISTCOEF", "ROTCOEF", "ODICOEFF", "OROCOEFF", "POLCALM", "CODEVER0", "CODEVER1", "CODEVER2", "CODEVER3", "CALVER64", "SERIES", "RECNUM", "SUNUM", "SLOTNUM", "SEGMENT" from hmi_m_45s_fits_header where "RECNUM" in (select recnum from pmd.hmi_m_45s) to '/tmp/hmi_m';
COPY (select lower(column_name), keyword, data_type, unit, comment from INFORMATION_SCHEMA.COLUMNS, hmi_m_45s_fits_keyword where column_name = keyword and table_name = 'hmi_m_45s_fits_header' ) TO '/tmp/hmi_m_keyword';
On db1
copy hmi_magnetogram.meta_data from '/tmp/hmi_m';
copy hmi_magnetogram.keyword from '/tmp/hmi_m_keyword';
insert into hmi_magnetogram.data_location (url, id)  select 'http://sdo.oma.be/PMD/download_data/hmi_m_45s/'||recnum , id from hmi_magnetogram.meta_data;
